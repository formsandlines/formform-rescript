!function(r,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.formform=n():r.formform=n()}(this,(function(){return function(){"use strict";var r={d:function(n,t){for(var e in t)r.o(t,e)&&!r.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})},o:function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},r:function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},n={};r.d(n,{default:function(){return Pn}});var t={};r.r(t),r.d(t,{Const:function(){return $},Nested:function(){return H},jsConst:function(){return J}});var e={};r.r(e),r.d(e,{fromIntArr:function(){return Er},fromIntArrUnsafe:function(){return hr},fromStrArr:function(){return Ar},fromStrArrUnsafe:function(){return Tr},genRandom:function(){return sr},getSize:function(){return cr},inv:function(){return Nr},isValidLength:function(){return ar},make:function(){return vr},makeUnsafe:function(){return dr},raw:function(){return wr},rel:function(){return Gr},reorderToNMUI:function(){return _r},show:function(){return mr},toArray:function(){return lr}});var u={};r.r(u),r.d(u,{calcRE:function(){return Dr},getUType:function(){return Vr},mnFromStr:function(){return Rr},recIdent:function(){return Lr},recInstr:function(){return Mr},showMN:function(){return yr},showSig:function(){return Ir},showUType:function(){return Sr},sigFromJs:function(){return gr},sigToJs:function(){return pr}});var o={};r.r(o),r.d(o,{DepthTree:function(){return nn},FCON:function(){return Zr},FORM:function(){return Yr},FVAR:function(){return rn},FormDNA:function(){return Qr},Sequence:function(){return Wr}});var i={};r.r(i),r.d(i,{Lexer:function(){return tn},Parser:function(){return en}});var f={};r.r(f),r.d(f,{VMap:function(){return sn},VPoint:function(){return vn},VSpace:function(){return _n},VTable:function(){return ln}});var c={};r.r(c),r.d(c,{Isolator:function(){return wn},Pattern:function(){return Nn},PrimAlg:function(){return Gn}});var a={};function v(r,n,t){for(var e=new Array(t),u=0,o=n;u<t;)e[u]=r[o],u=u+1|0,o=o+1|0;return e}function d(r,n){if(n<0||n>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return r[n]}function s(r,n){for(;;){var t=n,e=r,u=e.length,o=0===u?1:u,i=o-t.length|0;if(0===i)return e.apply(null,t);if(i>=0)return function(r,n){return function(t){return s(r,n.concat([t]))}}(e,t);n=v(t,o,0|-i),r=e.apply(null,v(t,0,o))}}function l(r,n){var t=r.length;if(1===t)return r(n);switch(t){case 1:return r(n);case 2:return function(t){return r(n,t)};case 3:return function(t,e){return r(n,t,e)};case 4:return function(t,e,u){return r(n,t,e,u)};case 5:return function(t,e,u,o){return r(n,t,e,u,o)};case 6:return function(t,e,u,o,i){return r(n,t,e,u,o,i)};case 7:return function(t,e,u,o,i,f){return r(n,t,e,u,o,i,f)};default:return s(r,[n])}}function _(r){return 1===r.length?r:function(n){return l(r,n)}}function E(r,n,t){var e=r.length;if(2===e)return r(n,t);switch(e){case 1:return s(r(n),[t]);case 2:return r(n,t);case 3:return function(e){return r(n,t,e)};case 4:return function(e,u){return r(n,t,e,u)};case 5:return function(e,u,o){return r(n,t,e,u,o)};case 6:return function(e,u,o,i){return r(n,t,e,u,o,i)};case 7:return function(e,u,o,i,f){return r(n,t,e,u,o,i,f)};default:return s(r,[n,t])}}function h(r){return 2===r.length?r:function(n,t){return E(r,n,t)}}function A(r){return void 0===r?{BS_PRIVATE_NESTED_SOME_NONE:0}:null!==r&&void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?{BS_PRIVATE_NESTED_SOME_NONE:r.BS_PRIVATE_NESTED_SOME_NONE+1|0}:r}function T(r){return function(r,n){for(;;){var t=n,e=r;if(!e)return t;n={hd:e.hd,tl:t},r=e.tl}}(r,0)}function m(r,n){return r<n?-1:r===n?0:1}function w(r,n){return r===n?0:r<n?-1:1}function N(r,n){return function(r,n){if(r<=0)return[];for(var t=new Array(r),e=0;e<r;++e)t[e]=n(e);return t}(r,_(n))}function G(r,n,t){return function(r,n,t){for(var e=r.length,u=n.length,o=e<u?e:u,i=new Array(o),f=0;f<o;++f)i[f]=t(r[f],n[f]);return i}(r,n,h(t))}function p(r,n){for(var t=r.length,e=n.length,u=new Array(t+e|0),o=0;o<t;++o)u[o]=r[o];for(var i=0;i<e;++i)u[t+i|0]=n[i];return u}function g(r,n,t){return function(r,n,t){for(var e=n,u=0,o=r.length;u<o;++u)e=t(e,r[u]);return e}(r,n,h(t))}function R(r,n){for(;;){var t=n,e=r;if(!e)return t;var u={hd:e.hd,tl:0};t.tl=u,n=u,r=e.tl}}function I(r,n){return function(r,n){if(!r)return 0;var t={hd:n(r.hd),tl:0};return function(r,n,t){for(;;){var e=n,u=r;if(!u)return;var o={hd:t(u.hd),tl:0};e.tl=o,n=o,r=u.tl}}(r.tl,t,n),t}(r,_(n))}function y(r,n){return function(r,n){if(!r)return 0;var t={hd:n(0,r.hd),tl:0};return function(r,n,t,e){for(;;){var u=e,o=t,i=n;if(!o)return;var f={hd:r(i,o.hd),tl:0};u.tl=f,e=f,t=o.tl,n=i+1|0}}(n,1,r.tl,t),t}(r,h(n))}function S(r){for(var n=r,t=0;;){if(!n)return t;t=t+1|0,n=n.tl}}function V(r){for(var n=r.length-1|0,t=0;;){var e=t,u=n;if(u<0)return e;t={hd:r[u],tl:e},n=u-1|0}}function D(r){var n=S(r),t=new Array(n);return function(r,n,t){for(;;){var e=t,u=n;if(!e)return;r[u]=e.hd,t=e.tl,n=u+1|0}}(t,0,r),t}function M(r,n,t){return function(r,n,t){for(;;){var e=r;if(!e)return n;n=t(n,e.hd),r=e.tl}}(r,n,h(t))}function L(r,n,t){return r?t(L(r.tl,n,t),r.hd):n}function P(r,n,t){return S(r)<1e3?L(r,n,t):function(r,n,t){for(var e=n,u=r.length-1|0;u>=0;--u)e=t(e,r[u]);return e}(D(r),n,t)}function O(r,n){return function(r,n){for(;;){var t=r;if(!t)return!1;if(n(t.hd))return!0;r=t.tl}}(r,_(n))}function b(r,n){return void 0!==r&&r?[0,3,1,2]:[0,1,2,3]}function X(r){switch(r){case 0:return"N";case 1:return"U";case 2:return"I";case 3:return"M"}}function k(r){switch(r){case"(mn)":case"I":case"i":return 2;case"()":case"M":case"m":return 3;case"":case"(())":case".":case"N":case"n":return 0;case"U":case"mn":case"u":return 1;default:return}}function F(r){switch(r){case 0:return 3;case 1:return 2;case 2:return 1;case 3:return 0}}function j(r,n){if(0===n)return r;switch(r){case 0:return n;case 1:return n>=2?3:1;case 2:return 2!==n?3:2;case 3:return 3}}function x(r){for(;;){var n=r;if(!n)return n;var t=n.hd;if(0===t){var e=n.tl;if(e&&0===e.hd){r=e.tl;continue}}return{hd:t,tl:x(n.tl)}}}function B(r){return{NAME:"NestToL",VAL:x(r.VAL)}}function U(r){return{NAME:"NestToR",VAL:x(r.VAL)}}function q(r,n){if(!r)return r;var t=r.tl,e=r.hd;return t?0!==e?e>=3?{hd:3,tl:0}:void 0!==n?n===e?{hd:0,tl:q(t,n)}:{hd:3,tl:0}:{hd:e,tl:q(t,e)}:{hd:0,tl:q(t,n)}:2!==e&&1!==e||void 0===n?r:n===e?{hd:0,tl:0}:{hd:3,tl:0}}function C(r){return{NAME:"NestToL",VAL:T(q(T(r.VAL),void 0))}}function K(r){return{NAME:"NestToR",VAL:q(r.VAL,void 0)}}function z(r){if(!r)return 0;var n=r.tl,t=r.hd;return n?0!==t?t>=3?3:j(t,F(z(n))):F(z(n)):t}r.r(a),r.d(a,{$$eval:function(){return Ln},Interpr:function(){return Mn},evalAll:function(){return Dn},evalSeq:function(){return Sn},interEval:function(){return Vn}});var J={tEnum:b,show:X,tFromStr:k,inv:F,rel:j},$={tEnum:b,tEnumList:function(r,n){return void 0!==r&&r?{hd:0,tl:{hd:3,tl:{hd:1,tl:{hd:2,tl:0}}}}:{hd:0,tl:{hd:1,tl:{hd:2,tl:{hd:3,tl:0}}}}},show:X,showAsKey:function(r){switch(r){case 0:return"N";case 1:return"U";case 2:return"I";case 3:return"M"}},toInt:function(r,n){var t=void 0!==r&&r,e=n+0|0;switch(e){case 0:return e;case 1:return t?2:e;case 2:return t?3:e;case 3:return t?1:e;default:return-99}},fromInt:function(r,n){var t=void 0!==r&&r,e=function(r){if(r<=3&&0<=r)return r-0|0}(n);if(!t)return e;if(void 0===e)return e;switch(e){case 0:return e;case 1:return 3;case 2:return 1;case 3:return 2}},tFromStr:k,inv:F,rel:j},H={show:function(r){if("NestToR"===r.NAME){var n=r.VAL;return n?"("+P(n,"",h((function(r,n){return X(n)+(r.length>0?"("+r+")":"")})))+")":"M"}var t=r.VAL;return t?"("+M(t,"",(function(r,n){return(r.length>0?"("+r+")":"")+X(n)}))+")":"M"},getList:function(r){return r.VAL},fromArrayToL:function(r){return{NAME:"NestToL",VAL:V(r)}},fromArrayToR:function(r){return{NAME:"NestToR",VAL:V(r)}},toArray:function(r){return D(r.VAL)},fmapL:function(r,n){return{NAME:"NestToL",VAL:l(n,r.VAL)}},fmapR:function(r,n){return{NAME:"NestToR",VAL:l(n,r.VAL)}},reduceByCrossingL:B,reduceByCrossingR:U,reduceByCallingL:C,reduceByCallingR:K,reduceL:function(r){return B(C({NAME:"NestToL",VAL:r.VAL}))},reduceR:function(r){return U(K({NAME:"NestToR",VAL:r.VAL}))},calcL:function(r){var n=r.VAL;return n?F(z(T(n))):3},calcR:function(r){var n=r.VAL;return n?F(z(n)):3}},Q=function(r,n){for(var t in r)n(t)};function W(r,n){if(r===n)return 0;var t,e=typeof r,u=typeof n;switch(e){case"boolean":if("boolean"===u)return t=n,r?t?0:1:t?-1:0;break;case"function":if("function"===u)throw{RE_EXN_ID:"Invalid_argument",_1:"compare: functional value",Error:new Error};break;case"number":if("number"===u)return m(r,n);break;case"string":return"string"===u?w(r,n):1;case"undefined":return-1}switch(u){case"string":return-1;case"undefined":return 1;default:if("boolean"===e)return 1;if("boolean"===u)return-1;if("function"===e)return 1;if("function"===u)return-1;if("number"===e)return null===n||void 0!==n.BS_PRIVATE_NESTED_SOME_NONE?1:-1;if("number"===u)return null===r||void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?-1:1;if(null===r)return void 0!==n.BS_PRIVATE_NESTED_SOME_NONE?1:-1;if(null===n)return void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?-1:1;if(void 0!==r.BS_PRIVATE_NESTED_SOME_NONE)return void 0!==n.BS_PRIVATE_NESTED_SOME_NONE?Y(r,n):-1;var o=0|r.TAG,i=0|n.TAG;if(248===o)return m(r[1],n[1]);if(251===o)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: abstract value",Error:new Error};if(o!==i)return o<i?-1:1;var f=0|r.length,c=0|n.length;if(f===c){if(!Array.isArray(r))return r instanceof Date&&n instanceof Date?r-n:Y(r,n);for(var a=0;;){var v=a;if(v===f)return 0;var d=W(r[v],n[v]);if(0!==d)return d;a=v+1|0}}else if(f<c)for(var s=0;;){var l=s;if(l===f)return-1;var _=W(r[l],n[l]);if(0!==_)return _;s=l+1|0}else for(var E=0;;){var h=E;if(h===c)return 1;var A=W(r[h],n[h]);if(0!==A)return A;E=h+1|0}}}function Y(r,n){var t={contents:void 0},e={contents:void 0},u=function(r,n){var t=r[2],e=r[1];if(!e.hasOwnProperty(n)||W(r[0][n],e[n])>0){var u=t.contents;return void 0!==u&&n>=u?void 0:void(t.contents=n)}},o=[r,n,e],i=[n,r,t];Q(r,(function(r){return u(o,r)})),Q(n,(function(r){return u(i,r)}));var f=t.contents,c=e.contents;return void 0!==f?void 0!==c?w(f,c):-1:void 0!==c?1:0}function Z(r,n){if(r===n)return!0;var t=typeof r;if("string"===t||"number"===t||"boolean"===t||"undefined"===t||null===r)return!1;var e=typeof n;if("function"===t||"function"===e)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: functional value",Error:new Error};if("number"===e||"undefined"===e||null===n)return!1;var u=0|r.TAG,o=0|n.TAG;if(248===u)return r[1]===n[1];if(251===u)throw{RE_EXN_ID:"Invalid_argument",_1:"equal: abstract value",Error:new Error};if(u!==o)return!1;var i=0|r.length;if(i!==(0|n.length))return!1;if(!Array.isArray(r)){if(r instanceof Date&&n instanceof Date)return!(r>n||r<n);var f={contents:!0};return Q(r,(function(r){n.hasOwnProperty(r)||(f.contents=!1)})),f.contents&&Q(n,(function(t){r.hasOwnProperty(t)&&Z(n[t],r[t])||(f.contents=!1)})),f.contents}for(var c=0;;){var a=c;if(a===i)return!0;if(!Z(r[a],n[a]))return!1;c=a+1|0}}var rr={contents:0};function nr(r){return rr.contents=rr.contents+1|0,r+"/"+rr.contents}var tr=nr("Helper-Formform.Unreachable");function er(r,n){return r?{hd:n,tl:{hd:r.hd,tl:er(r.tl,n)}}:0}function ur(r,n){return r?{hd:r.hd,tl:er(r.tl,n)}:0}function or(r){return r?r.hd+or(r.tl):""}var ir=function(r,n){return or(ur(r,n))},fr="abcdefghijklmnopqrstuvwxyz".split("");function cr(r){var n=r.length;return Math.log(n)/Math.log(4)|0}function ar(r){return void 0!==function(r){var n=Math.log(r)/Math.log(4);return!Number.isFinite(n)||function(r){return(0|r)<r}(n)?void 0:0|n}(r)}function vr(r){if(ar(r.length))return r}function dr(r){if(ar(r.length))return r;throw{RE_EXN_ID:"Not_found",Error:new Error}}function sr(r){return[]}function lr(r){return r}function _r(r){var n=r.length;if(n<4)return r;var t=n/4|0;return function(r){for(var n=r.length,t=0,e=0;e<n;++e)t=t+r[e].length|0;var u=new Array(t);t=0;for(var o=0;o<n;++o)for(var i=r[o],f=0,c=i.length;f<c;++f)u[t]=i[f],t=t+1|0;return u}(N(4,(function(e){var u;switch(e){case 0:u=1;break;case 1:u=2;break;case 2:u=0;break;default:u=e}var o=Math.imul(u,t),i=r.slice(o,o+t|0);return n>4?_r(i):i})))}function Er(r,n){var t=void 0!==r&&r;return!1===ar(n.length)?void 0:n.map((function(r){var n=$.fromInt(t,r);if(void 0!==n)return n;throw{RE_EXN_ID:"Not_found",Error:new Error}}))}function hr(r,n){var t=Er(void 0!==r&&r,n);if(void 0!==t)return t;throw{RE_EXN_ID:"Not_found",Error:new Error}}function Ar(r){return!1===ar(r.length)?void 0:r.map((function(r){var n=$.tFromStr(r);if(void 0!==n)return n;throw{RE_EXN_ID:"Not_found",Error:new Error}}))}function Tr(r){var n=Ar(r);if(void 0!==n)return n;throw{RE_EXN_ID:"Not_found",Error:new Error}}function mr(r,n,t){var e=void 0!==r&&r,u=void 0!==n&&n,o=e?_r(t):t,i=(e?"::":"⁘")+(u?" ":"");return Z(o,[])?i+$.toInt(e,0).toString():i+o.reduce((function(r,n,t){return r+(u&&t>0&&t%4==0?" ":"")+$.toInt(e,n).toString()}),"")}function wr(r){return Z(r,[])?$.showAsKey(0):r.map((function(r){return $.showAsKey(r)})).join("")}function Nr(r){return Z(r,[])?[$.inv(0)]:r.map((function(r){return $.inv(r)}))}function Gr(r,n){var t=r.length,e=n.length,u=t<=e?[r,n,t,e]:[n,r,e,t],o=u[3],i=u[2],f=u[1],c=G(f,u[0],(function(r,n){return $.rel(r,n)}));return i===o?c:p(c,function(r,n,t){if(t<=0)return[];var e,u=r.length,o=n<0?(e=u+n|0)>0?e:0:n,i=u-o|0,f=i<t?i:t;if(f<=0)return[];for(var c=new Array(f),a=0;a<f;++a)c[a]=r[o+a|0];return c}(f,i,o))}function pr(r){return{reEntryPar:r.reEntryPar,unmarked:r.unmarked,interpr:r.interpr}}function gr(r){return{reEntryPar:r.reEntryPar,unmarked:r.unmarked,interpr:r.interpr}}function Rr(r){switch(r){case"RecIdent":case"Recursive Identity":case"id":case"rId":case"recIdent":return 1;case"RecInstr":case"Recursive Instruction":case"in":case"rIn":case"recInstr":return 0;default:throw{RE_EXN_ID:"Not_found",Error:new Error}}}function Ir(r){var n;switch(r.reEntryPar){case 0:n=["..",""];break;case 1:n=["..","."];break;case 2:n=["",""]}var t=r.interpr?"@'":"@";return(r.unmarked?"_":"")+n[1]+t+n[0]}function yr(r){return r?"recursive identity":"recursive instruction"}function Sr(r){return r?"iFORM":"uFORM"}function Vr(r,n){switch(n){case 0:return r.unmarked?1:0;case 1:switch(r.reEntryPar){case 0:return 0;case 1:case 2:return 1}case 2:return 1}}function Dr(r,n){var t=n.VAL,e=r.interpr,u=r.unmarked,o=r.reEntryPar,i=0===t||function(r){for(var n=0,t=r;;){var e=n;if(!t)return e;t=t.tl,n=e+1|0}}(t)%2!=0?1:0,f=Vr({reEntryPar:o,unmarked:u,interpr:e},i);if(0===t||function(r,n){for(;;){var t=r;if(!t)return!0;if(!n(t.hd))return!1;r=t.tl}}(t,_((function(r){return 0===r}))))return f?2:1;var c=u||1!==i||0!==o?t:function(r,n){if(!r)return n;var t={hd:r.hd,tl:0};return R(r.tl,t).tl=n,t}(t,t);if(O(c,(function(r){return 3===r}))||O(c,(function(r){return 1===r}))&&O(c,(function(r){return 2===r}))){var a=H.calcR(H.reduceR({NAME:"NestToR",VAL:c}));return u?$.inv(a):a}var v=H.reduceR({NAME:"NestToR",VAL:c}).VAL,d=function(r){if(r)return A(r.hd)}(v);if(1===e&&!u&&Z(d,0)){if(v){var s=v.tl;if(s){var l=s.hd;return f?$.rel(2,l):$.rel(1,l)}throw{RE_EXN_ID:tr,Error:new Error}}throw{RE_EXN_ID:tr,Error:new Error}}if(1===e&&u&&!Z(d,0)){if(void 0!==d)return f?$.rel(2,d):$.rel(1,d);throw{RE_EXN_ID:tr,Error:new Error}}if(u){if(v){var E=v.hd;if(0!==E){if(E>=3)throw{RE_EXN_ID:tr,Error:new Error};var h=v.tl;if(!h)return 0===o?2:1;if(0!==h.hd)throw{RE_EXN_ID:tr,Error:new Error};if(!h.tl)return 1;throw{RE_EXN_ID:tr,Error:new Error}}var T=v.tl;if(T){if(T.hd-1>>>0>1)throw{RE_EXN_ID:tr,Error:new Error};var m=T.tl;if(!m)return 2;if(0!==m.hd)throw{RE_EXN_ID:tr,Error:new Error};if(m.tl)throw{RE_EXN_ID:tr,Error:new Error};return 0===o?1:2}throw{RE_EXN_ID:tr,Error:new Error}}throw{RE_EXN_ID:tr,Error:new Error}}if(v){var w=v.hd;if(0!==w){if(w>=3)throw{RE_EXN_ID:tr,Error:new Error};var N=v.tl;if(!N)return 0===o?1:2;if(0!==N.hd)throw{RE_EXN_ID:tr,Error:new Error};if(!N.tl)return 1;throw{RE_EXN_ID:tr,Error:new Error}}var G=v.tl;if(G){if(G.hd-1>>>0>1)throw{RE_EXN_ID:tr,Error:new Error};var p=G.tl;if(!p)return 2;if(0!==p.hd)throw{RE_EXN_ID:tr,Error:new Error};if(p.tl)throw{RE_EXN_ID:tr,Error:new Error};return 0===o?2:1}throw{RE_EXN_ID:tr,Error:new Error}}throw{RE_EXN_ID:tr,Error:new Error}}var Mr=0,Lr=1;function Pr(r,n,t){var e=void 0!==r?r.h:0,u=void 0!==t?t.h:0;return{v:n,h:(e>=u?e:u)+1|0,l:r,r:t}}function Or(r,n){return void 0===n||void 0!==r&&r.h>=n.h}function br(r,n,t){var e=void 0!==r?r.h:0,u=void 0!==t?t.h:0;if(e>(u+2|0)){var o=r.l,i=r.r;return Or(o,i)?Pr(o,r.v,Pr(i,n,t)):Pr(Pr(o,r.v,i.l),i.v,Pr(i.r,n,t))}if(u<=(e+2|0))return{v:n,h:(e>=u?e:u)+1|0,l:r,r:t};var f=t.l,c=t.r;return Or(c,f)?Pr(Pr(r,n,f),t.v,c):Pr(Pr(r,n,f.l),f.v,Pr(f.r,t.v,c))}function Xr(r){var n=r.l,t=r.r;return(1+(void 0!==n?Xr(n):0)|0)+(void 0!==t?Xr(t):0)|0}function kr(r,n,t){for(;;){var e=n,u=r,o=u.v,i=u.l,f=u.r,c=void 0!==i?kr(i,e,t):e;t[c]=o;var a=c+1|0;if(void 0===f)return a;n=a,r=f}}function Fr(r,n,t){if(void 0===r)return function(r){return{v:r,h:1,l:void 0,r:void 0}}(n);var e=r.v,u=t(n,e);if(0===u)return r;var o=r.l,i=r.r;if(u<0){var f=Fr(o,n,t);return f===o?r:br(f,e,i)}var c=Fr(i,n,t);return c===i?r:br(o,e,c)}var jr=function(r){if(void 0===r)return[];var n=Xr(r),t=new Array(n);return kr(r,0,t),t};function xr(r,n){var t=void 0!==r&&r;switch(0|n.TAG){case 0:return"("+Br(t,n._0)+")";case 1:return $.show(n._0);case 2:return"{"+Ur(t,n._1)+" "+Ir(n._0)+"}";case 3:return"/"+n._0+"/";case 4:var e=n._0;return 1===e.length?e:'"'+e+'"';case 5:return"["+qr(t,n._0)+"]"}}function Br(r,n){var t=void 0!==r&&r;return n.map((function(r){return xr(t,r)})).join("")}function Ur(r,n){var t=void 0!==r&&r;return ir(I(n,(function(r){return Br(t,r)})),",")}function qr(r,n){var t,e=n.vars,u=n.form,o=void 0!==r&&r;if(void 0!==u)if(void 0!==e){var i=e.join(",");t=Br(o,u)+".["+i+"]"}else t=Br(o,u);else t="";return t+mr(o,void 0,n.dna)}function Cr(r,n,t){return g(t,n,(function(n,t){var e=E(r,n,t);switch(0|t.TAG){case 0:return Cr(r,e,t._0);case 2:return M(t._1,e,(function(n,t){return Cr(r,n,t)}));default:return e}}))}function Kr(r){switch(0|r.TAG){case 0:return{TAG:0,_0:r._0.map(Kr)};case 1:return{TAG:1,_0:r._0};case 2:return{TAG:2,_0:r._0,_1:I(r._1,(function(r){return r.map(Kr)}))};case 3:return{TAG:3,_0:r._0};case 5:return{TAG:5,_0:zr(r._0)}}}function zr(r){var n=r.form,t=void 0!==n?n.map(Kr):void 0;return{dna:r.dna,form:t,vars:r.vars}}function Jr(r,n,t){return g(t,n,(function(n,t){var e=E(r,n,t);switch(0|t.TAG){case 0:return Jr(r,e,t._0);case 2:return M(t._1,e,(function(n,t){return Jr(r,n,t)}));default:return e}}))}function $r(r){return 0===r.TAG?"{ index: "+r.index.join("")+", form: '"+xr(void 0,r.form)+"', children: ["+r.children.map($r).join(", ")+"] }":"{ index: "+r.index.join("")+", form: '"+xr(void 0,r.form)+"' }"}function Hr(r,n){return 0===r.TAG?{TAG:0,index:n,form:r,children:r._0.map((function(r,t){return Hr(r,n.concat([t]))}))}:{TAG:1,index:n,form:r}}var Qr={show:qr,dnaToFORM:function(r){return[]},toFORM:function(r){return[]}},Wr={show:Ur,toFORMt:function r(n){if(!n)return{TAG:0,_0:[]};var t=n.tl,e=n.hd;return t?{TAG:0,_0:p(e,[r(t)])}:{TAG:0,_0:e}}},Yr={mark:function(r){return{TAG:0,_0:r}},cVal:function(r){return{TAG:1,_0:r}},seqRE:function(r,n){return{TAG:2,_0:r,_1:n}},uncl:function(r){return{TAG:3,_0:r}},fVar:function(r){return{TAG:4,_0:r}},fDna:function(r){return{TAG:5,_0:r}},show:Br},Zr={reduce:function(r,n,t){return Cr(n,t,r)},toFVAR:function(r){return r.map(Kr)}},rn={reduce:function(r,n,t){return Jr(n,t,r)},getVars:function(r){return function(r){return jr(r.data)}(Jr((function(r,n){return 4===n.TAG?function(r,n){var t=r.data,e=r.cmp,u=Fr(t,n,e);return u===t?r:{cmp:e,data:u}}(r,n._0):r}),function(r){return{cmp:r.cmp,data:void 0}}({cmp:h(W)}),r))},countVars:function(r){return Jr((function(r,n){return 4===n.TAG?r+1|0:r}),0,r)}},nn={show:function(r){return"{ root, form: '"+Br(void 0,r.form)+"', children: ["+r.children.map($r).join(", ")+"] }"},parse:function(r){return{form:r,children:r.map((function(r,n){return Hr(r,[n])}))}},testTrees:[{form:[],children:[]},{form:[{TAG:1,_0:1}],children:[{TAG:1,index:[0],form:{TAG:1,_0:1}}]},{form:[{TAG:0,_0:[]}],children:[{TAG:0,index:[0],form:{TAG:0,_0:[]},children:[]}]},{form:[{TAG:0,_0:[{TAG:1,_0:3},{TAG:0,_0:[]}]}],children:[{TAG:0,index:[0],form:{TAG:0,_0:[{TAG:1,_0:3},{TAG:0,_0:[]}]},children:[{TAG:1,index:[0,0],form:{TAG:1,_0:3}},{TAG:0,index:[0,1],form:{TAG:0,_0:[]},children:[]}]}]}]},tn={},en={parse:function(r){return[]}},un=2147483647,on=-2147483648;function fn(r){return r>un?un:r<on?on:Math.floor(r)}function cn(r){return D(I(r,(function(r){return $.showAsKey(r)}))).join("")}function an(r,n){var t=void 0!==r&&r,e=n.split("").map((function(r){var n=function(r){var n=parseInt(r,10);return isNaN(n)?void 0:n}(r);return void 0!==n?$.fromInt(t,n):$.tFromStr(r)}));if(e.every((function(r){return void 0!==r})))return V(e.map((function(r){return r})))}var vn={show:function(r){return"["+D(I(r,(function(r){return $.show(r)}))).join(",")+"]"},showAsKey:cn,tFromStr:an};function dn(r,n){var t=void 0!==r&&r;return N(fn(Math.pow(4,n)),(function(r){var e,u,o=(e=r.toString(4),u=n,"0",e.padStart(u,"0")),i=an(t,o);if(void 0!==i)return i;throw{RE_EXN_ID:"Not_found",Error:new Error}}))}var sn={},ln={show:function(r){return""},makeFromDNA:function(r){var n=r;return function(r){for(var n={},t=r.length,e=0;e<t;++e){var u=r[e];n[u[0]]=u[1]}return n}(G(dn(void 0,fn(Math.log(n.length)/Math.log(4))),n.reverse(),(function(r,n){return[cn(r),n]})))}},_n={toArray:function(r){return r},make:dn,toDNA:function(r,n){return dr(r.map(_(n)).reverse())}};function En(r){return{TAG:0,_0:[{TAG:2,_0:{reEntryPar:2,unmarked:!1,interpr:0},_1:{hd:[{TAG:0,_0:[{TAG:4,_0:r}]}],tl:0}},{TAG:2,_0:{reEntryPar:0,unmarked:!1,interpr:0},_1:{hd:[{TAG:0,_0:[{TAG:4,_0:r}]}],tl:0}}]}}function hn(r){return{TAG:0,_0:[{TAG:2,_0:{reEntryPar:2,unmarked:!1,interpr:0},_1:{hd:[{TAG:4,_0:r}],tl:0}},{TAG:2,_0:{reEntryPar:0,unmarked:!1,interpr:0},_1:{hd:[{TAG:4,_0:r}],tl:0}}]}}function An(r){return{TAG:0,_0:[{TAG:0,_0:[{TAG:2,_0:{reEntryPar:2,unmarked:!1,interpr:0},_1:{hd:[{TAG:0,_0:[{TAG:4,_0:r}]}],tl:0}},{TAG:4,_0:r}]},{TAG:0,_0:[{TAG:2,_0:{reEntryPar:0,unmarked:!1,interpr:0},_1:{hd:[{TAG:4,_0:r}],tl:0}},{TAG:0,_0:[{TAG:4,_0:r}]}]}]}}function Tn(r){return{TAG:0,_0:[{TAG:0,_0:[{TAG:2,_0:{reEntryPar:2,unmarked:!1,interpr:0},_1:{hd:[{TAG:4,_0:r}],tl:0}},{TAG:0,_0:[{TAG:4,_0:r}]}]},{TAG:0,_0:[{TAG:2,_0:{reEntryPar:0,unmarked:!1,interpr:0},_1:{hd:[{TAG:0,_0:[{TAG:4,_0:r}]}],tl:0}},{TAG:4,_0:r}]}]}}function mn(r,n){switch(r){case 0:return En(n);case 1:return An(n);case 2:return Tn(n);case 3:return hn(n)}}var wn={n:En,m:hn,u:An,i:Tn,get:mn,fromVPoint:function(r,n){var t=void 0!==r?r:fr;if(t.length<S(n))throw function(r){throw new RangeError("Insufficient variables in given list!")}();return{TAG:0,_0:D(y(n,(function(r,n){return{TAG:0,_0:[mn(n,d(t,r))]}})))}}},Nn={Imply:{apply:function(r,n){var t=l(n,r);return void 0!==t?t:r}},Equiv:{applyL:function(r,n){var t=l(n[0],r);return void 0!==t?t:r},applyR:function(r,n){var t=l(n[1],r);return void 0!==t?t:r}}},Gn={refl:[function(r){return[{TAG:0,_0:[{TAG:0,_0:r}]}]},function(r){if(1===r.length){var n=r[0];if(0===n.TAG){var t=n._0;if(1===t.length){var e=t[0];return 0===e.TAG?e._0:void 0}}}}]};function pn(r,n){if(S(r)===n.length)return A(function(r){for(var n={},t=r;;){var e=t;if(!e)return n;var u=e.hd;n[u[0]]=u[1],t=e.tl}}(y(r,(function(r,t){return[n[r],t]}))))}function gn(r,n){return r.map((function(r){switch(0|r.TAG){case 0:return{TAG:0,_0:gn(r._0,n)};case 1:return{TAG:1,_0:r._0};case 2:return{TAG:2,_0:r._0,_1:In(r._1,n)};case 3:return{TAG:3,_0:r._0};case 4:var t=function(r,n){if(n in r)return A(r[n])}(n,r._0);if(void 0!==t)return{TAG:1,_0:t};throw{RE_EXN_ID:"Not_found",Error:new Error};case 5:return{TAG:5,_0:Rn(r._0,n)}}}))}function Rn(r,n){var t=r.form,e=void 0!==t?gn(t,n):void 0;return{dna:r.dna,form:e,vars:void 0}}function In(r,n){return I(r,(function(r){return gn(r,n)}))}function yn(r){return r.reduce((function(r,n){return $.rel(r,function(r){switch(0|r.TAG){case 0:var n=r._0;return 0!==n.length?$.inv(yn(n)):3;case 1:return r._0;case 2:return Dr(r._0,{NAME:"NestToR",VAL:I(r._1,yn)});case 3:return 1;case 5:return 0}}(n))}),0)}function Sn(r){if(!r)return 3;var n=r.tl,t=r.hd;return n?$.inv($.rel(yn(t),Sn(n))):$.inv(yn(t))}function Vn(r,n){return yn(gn(r,n))}function Dn(r){var n=rn.getVars(r),t=n.length,e=_n.make(void 0,t);return{dna:dr(_n.toArray(e).map((function(t){var e=pn(t,n);if(void 0!==e)return yn(gn(r,function(r){if(null===r||void 0===r.BS_PRIVATE_NESTED_SOME_NONE)return r;var n=r.BS_PRIVATE_NESTED_SOME_NONE;return 0===n?void 0:{BS_PRIVATE_NESTED_SOME_NONE:n-1|0}}(e)));throw{RE_EXN_ID:"Not_found",Error:new Error}})).reverse()),form:r,vars:n}}var Mn={toVPoint:function(r){return V(function(r){for(var n=Object.keys(r),t=n.length,e=new Array(t),u=0;u<t;++u)e[u]=r[n[u]];return e}(r))},fromVPoint:pn,interpret:gn},Ln=yn,Pn={Calc:t,DNA:e,SeqRE:u,Expr:o,Formula:i,Value:f,Alg:c,Eval:a};return n.default}()}));
//# sourceMappingURL=formformRAW.min.js.map